<!DOCTYPE html>
<html>

<head>
<title>KAIZEN - Profile</title>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Kaizen Platform">
<meta name="author" content="Hamza Zaroual">
<link href="/assets/img/brand/share.png" rel="icon" type="image/png">
<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700"
	rel="stylesheet">
<link href="/assets/vendor/nucleo/css/nucleo.css" rel="stylesheet">
<link
	href="/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css"
	rel="stylesheet">
<link type="text/css" href="/assets/css/argon.css?v=1.0.0"
	rel="stylesheet">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.22/css/uikit.min.css" />
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.22/js/uikit.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.22/js/uikit-icons.min.js"></script>
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<style>
html, body {
	overflow-x: hidden;
}
</style>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.css">
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
</head>

<body>
	<!-- Sidenav -->
	<nav
		class="navbar navbar-vertical fixed-left navbar-expand-md navbar-light bg-white"
		id="sidenav-main">
		<div class="container-fluid">
			<!-- Toggler -->
			<button class="navbar-toggler" type="button" data-toggle="collapse"
				data-target="#sidenav-collapse-main" aria-controls="sidenav-main"
				aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<!-- Brand -->
			<a class="navbar-brand pt-0" href=""> <img
				src="/assets/img/brand/blue.png" class="navbar-brand-img" alt="Logo">
			</a>
			<!-- User -->
			<ul class="nav align-items-center d-md-none">
				<li class="nav-item dropdown"><a class="nav-link" href="#"
					role="button" data-toggle="dropdown" aria-haspopup="true"
					aria-expanded="false">
						<div class="media align-items-center">
							<span class="avatar avatar-sm rounded-circle">
									<span th:if="${user_details.getAvatar() != null}">
							<img alt="Avatar" class="rounded-circle" th:src="@{getImage(id=${user_details.getId()})}">
									</span>
									<span th:if="${user_details.getAvatar() == 'default.jpg' || user_details.getAvatar() == null}">
							<img alt="Avatar" class="rounded-circle" th:src="'/uploads/avatars/default.jpg'">
									</span>

							</span>
						</div>
				</a>
					<div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
						<div class=" dropdown-header noti-title">
							<h6 class="text-overflow m-0">Welcome!</h6>
						</div>
						<a href="/profile" class="dropdown-item"> <i
							class="ni ni-single-02"></i> <span>My profile</span>
						</a>
						<div class="dropdown-divider"></div>
						<a href="#!" class="dropdown-item"> <i class="ni ni-user-run"></i>
							<span>Logout</span>
						</a>
					</div></li>
			</ul>
			<!-- Collapse -->
			<div class="collapse navbar-collapse" id="sidenav-collapse-main">
				<!-- Collapse header -->
				<div class="navbar-collapse-header d-md-none">
					<div class="row">
						<div class="col-6 collapse-brand">
							<a href="../index.html"> <img
								src="/assets/img/brand/blue.png">
							</a>
						</div>
						<div class="col-6 collapse-close">
							<button type="button" class="navbar-toggler"
								data-toggle="collapse" data-target="#sidenav-collapse-main"
								aria-controls="sidenav-main" aria-expanded="false"
								aria-label="Toggle sidenav">
								<span></span> <span></span>
							</button>
						</div>
					</div>
				</div>
				<ul class="navbar-nav">
					<li class="nav-item"><a class="nav-link" href="/kaizen/admin/dashboard">
							<i class="ni ni-tv-2 text-primary"></i> Dashboard
					</a></li>
					<li class="nav-item"><a class="nav-link" href="/kaizen/admin/users"> <i
							class="ni ni-single-02 text-primary"></i> Users List
					</a></li>
					<li class="nav-item"><a class="nav-link" href="/kaizen/admin/report"> <i
							class="ni ni-archive-2 text-primary"></i> Reports
					</a></li>
				</ul>
				<!-- Divider -->
				<hr class="my-3">
				<ul class="navbar-nav">
					<li class="nav-item"><a class="nav-link"
						href="/kaizen/admin/suggestionslist"> <i
							class="ni ni-bullet-list-67 text-primary"></i> All Suggestions
					</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/kaizen/admin/suggestionssent"> <i
							class="ni ni-cloud-upload-96 text-primary"></i> Suggestions Sent
					</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/kaizen/admin/suggestionsreceived"> <i
							class="ni ni-cloud-download-95 text-primary"></i> Suggestions
							Received
					</a></li>
				</ul>
				<hr class="my-3">
				<div>
					<span class="heading">Committee Members :</span> <br>
					<th:block th:each="committee_member : ${committee_members}">
					<span class="description">
					 <span class="text-success">●</span> [[${committee_member.first_name}]] [[${committee_member.last_name}]] 
					<b>- [[${committee_member.department}]] </b>
					</span> <br>
					</th:block>
				</div>
			</div>
		</div>
	</nav>
	<!-- Main content -->
	<div class="main-content">
		<!-- Top navbar -->
		<nav class="navbar navbar-top navbar-expand-md navbar-dark"
			id="navbar-main">
			<div class="container-fluid">
				<!-- Brand -->
				<a
					class="h4 mb-0 text-white text-uppercase d-none d-lg-inline-block">Your
					Profile</a>
				<div style="margin-left: 100px">
					<!-- include flash-message -->
				</div>
				<!-- Include sweet alert -->
				<div th:if="${param.success}">
					<script type="text/javascript">
						//swal("Good job!", {{ $message }} , "success");
						swal("Well Saved", "Your profile has been successfully updated !", "success");
					</script>
				</div>
				<!-- Form -->
				<form
					class="navbar-search navbar-search-dark form-inline mr-3 d-none d-md-flex ml-lg-auto">
					<div class="form-group mb-0"></div>
				</form>
				<!-- User -->
				<ul class="navbar-nav align-items-center d-none d-md-flex">
					<li class="nav-item dropdown"><a class="nav-link pr-0"
						href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
						aria-expanded="false">
							<div class="media align-items-center">
								<span class="avatar avatar-sm rounded-circle">
									<span th:if="${user_details.getAvatar() != null}">
							<img alt="Avatar" class="rounded-circle" th:src="@{getImage(id=${user_details.getId()})}">
									</span>
									<span th:if="${user_details.getAvatar() == 'default.jpg' || user_details.getAvatar() == null}">
							<img alt="Avatar" class="rounded-circle" th:src="'/uploads/avatars/default.jpg'">
									</span>

							</span>
								<div class="media-body ml-2 d-none d-lg-block">
									<span class="mb-0 text-sm  font-weight-bold">[[${#strings.substring(user_details.getFirst_name(),0,1)}]].[[${user_details.getLast_name()}]]<!-- First Name & Last Name --></span>
								</div>
							</div>
					</a>
						<div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
							<div class=" dropdown-header noti-title">
								<h6 class="text-overflow m-0">Welcome!</h6>
							</div>
							<a href="/kaizen/admin/suggestionslist" class="dropdown-item"> <i
								class="ni ni-planet"></i> <span>Home</span>
							</a>
							<div class="dropdown-divider"></div>
							<a href="/logout"
								onclick="event.preventDefault();
                               document.getElementById('logout-form').submit();"
								class="dropdown-item"> <i class="ni ni-user-run"></i> <span>Logout</span>
							</a>
							<form id="logout-form" action="/logout" style="display: none;">
							</form>
						</div></li>
				</ul>
			</div>
		</nav>
		<!-- Header -->
		<div class="header pb-8 pt-5 pt-lg-8 d-flex align-items-center"
			style="max-height: 350px; background-image: url('/uploads/covers/Confetti-Doodles.svg'); background-size: cover; background-position: center top;">
			<!-- background-image: url('img/theme/Confetti-Doodles.svg') -->
			<!-- Mask -->
			<span class="mask bg-gradient-default opacity-8"></span>
			<!-- Header container -->
			<div class="container-fluid d-flex align-items-center">
				<div class="row">
					<div class="col-lg-12">
						<h1 class="display-2 text-white"
							th:text="'Hello ' + ${user_details.getFirst_name()}">
							<!-- First Name -->
						</h1>
						<form th:action="@{/update_profile}" th:method="post" enctype="multipart/form-data">
					</div>
				</div>
			</div>
		</div>
		<!-- Page content -->
		<div class="container-fluid mt--7">
			<div class="row">
				<div class="col-xl-4 order-xl-2 mb-5 mb-xl-0">
					<div class="card card-profile shadow">
						<div class="row justify-content-center">
							<div class="col-lg-3 order-lg-2">
								<div class="card-profile-image">
									<a href=""> 
										<span class="rounded-circle">
									<span th:if="${user_details.getAvatar() != null}">
							<img alt="Avatar" class="rounded-circle" th:src="@{getImage(id=${user_details.getId()})}">
									</span>
									<span th:if="${user_details.getAvatar() == 'default.jpg' || user_details.getAvatar() == null}">
							<img alt="Avatar" class="rounded-circle" th:src="'/uploads/avatars/default.jpg'">
									</span>

							</span>
									</a>
								</div>
							</div>
						</div>
						<div
							class="card-header text-center border-0 pt-8 pt-md-4 pb-0 pb-md-4">
							<div class="d-flex justify-content-between">
								<!--<a href="#" class="btn btn-sm btn-info mr-4">Add profile pic</a>-->
								<div class="js-upload" uk-form-custom>
									<input type="file" th:name="avatar" th:attr="value =${user_details.getAvatar()}">
									<input type="hidden" th:name="avatar" th:attr="value =${user_details.getAvatar()}" >
									<button class="btn btn-sm btn-info mr-4"
										style="width: 40px; height: 40px; border-radius: 50%"
										type="button" tabindex="-1">
										<img src="/assets/img/icons/photo-camera.png"
											alt="profile picture">
									</button>
									<!-- Edit profile pic-->
								</div>
								<a style="color: white; height: 27px"
									class="btn btn-sm btn-default float-right"><span class="text-success">●</span> Online</a>
							</div>
						</div>
						<div class="card-body pt-0 pt-md-4">
							<div class="row">
								<div class="col">
									<div
										class="card-profile-stats d-flex justify-content-center mt-md-5">
										<div>
											<span class="heading">[[${suggestion_sent}]]</span>
											<span class="description">Sugg.</span>
										</div>
										<div>
											<span class="heading">[[${team_member_count}]]<!-- Total of member of team for the user connected --></span>
											<span class="description">Team</span>
										</div>
									</div>
								</div>
							</div>
							<div class="text-center">
								<h3>
									<!-- First Name & Last Name -->
									[[${user_details.getFirst_name()}]]
									[[${user_details.getLast_name()}]]
								</h3>
								<div class="h5 mt-4">
									<i class="ni location_pin mr-2"></i>Joined in
									[[${#dates.format(user_details.getCreated_at(), 'dd MMMM
									yyyy')}]]
								</div>
								<div class="h5 font-weight-300">
									<i class="ni location_pin mr-2"></i>
									<!-- Town -->
									[[${user_details.getTown()}]],
									<!-- Country -->
									[[${user_details.getCountry()}]]
								</div>
								<div class="h5 mt-4">
									<i class="ni business_briefcase-24 mr-2"></i>
									<!-- Job title -->
									[[${user_details.getJob_title()}]] -
									<!-- Department -->
									[[${user_details.getDepartment()}]]
								</div>
								<div>
									<i class="ni education_hat mr-2"></i>
									<!-- Company -->
									[[${user_details.getCompany_name()}]]
								</div>
								<hr class="my-4" />
								<div>
									<span class="heading"></span> <span class="description"></span>
								</div>
								<div>
									<span class="heading">Team Members</span><br> <span
										th:if="${team_member_count} == 1"> <span
										class="description">No Team Member</span>
									</span> <span th:if="${team_member_count} > 1"> <span
										th:each="member_name : ${team_member}"> <span
											th:if="${member_name.first_name} == ${user_details.getFirst_name()} AND ${member_name.last_name} == ${user_details.getLast_name()}">
												<span class="description">You . </span>
										</span> <span class="description"
											th:if="${member_name.first_name} != ${user_details.getFirst_name()}">[[${member_name.first_name}]]
												<b>[[${member_name.last_name}]]</b> .
										</span>
									</span>
									</span>
								</div>
								<div>
									<span class="heading"></span> <span class="description"></span>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-8 order-xl-1">
					<div class="card bg-secondary shadow">
						<div class="card-header bg-white border-0">
							<div class="row align-items-center">
								<div class="col-8">
									<h3 class="mb-0">My account</h3>
								</div>
								<div class="col-4 text-right">
									<a href="/kaizen/admin/suggestionslist" class="btn btn-sm btn-primary">Home</a>
								</div>
							</div>
						</div>
						<div class="card-body">
							<h6 class="heading-small text-muted mb-4">User information</h6>
							<div class="pl-lg-4">
								<div class="row">
									<div class="col-lg-12">
										<div class="form-group">
										
										  <input type="hidden"
												class="form-control form-control-alternative"
												th:name="id" th:attr="value =${user_details.getId()}" readonly>
												
											<label class="form-control-label" for="input-email">Username/Email</label>
											<input type="email" th:id="email"
												class="form-control form-control-alternative"
												placeholder="Email" th:name="email"
												th:attr="value =${user_details.getEmail()}"
											    readonly>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-lg-6">
										<div class="form-group">
											<label class="form-control-label" for="input-first-name">First
												name</label> <input type="text" th:id="first-name"
												class="form-control form-control-alternative"
												placeholder="First Name" th:name="first_name"
												th:attr="value=${user_details.getFirst_name()}">
												<!-- th:value="${user_details.getFirst_name()}" -->
										</div>
									</div>
									<div class="col-lg-6">
										<div class="form-group">
											<label class="form-control-label" for="input-last-name">Last
												name</label> <input type="text" th:id="last-name"
												class="form-control form-control-alternative"
												placeholder="Last Name" th:name="last_name"
												th:attr="value=${user_details.getLast_name()}">
												<!-- th:value="${user_details.getLast_name()}" -->
										</div>
									</div>
								</div>
							</div>
							<div class="pl-lg-4">
								<div class="row">
									<div class="col-lg-4">
										<div class="form-group">
											<label class="form-control-label" for="input-department">Department</label>
											<input type="text" th:id="department"
												class="form-control form-control-alternative"
												th:name="department" placeholder="Department"
												th:attr="value=${user_details.getDepartment()}">
												<!-- th:value="${user_details.getDepartment()}" -->
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="form-control-label" for="input-job_title">Job
												Title</label> <input type="text" th:id="job_title"
												class="form-control form-control-alternative"
												th:name="job_title" placeholder="Job Title"
												th:attr="value=${user_details.getJob_title()}"
												>
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="form-control-label" for="supervisor">Department
												Manager</label> <input type="email" th:id="supervisor"
												class="form-control form-control-alternative"
												th:name="supervisor" placeholder="Department Manager"
												th:attr="value=${user_details.getSupervisor()}">
											<div id="supervisorlist"></div>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-lg-4">
										<div class="form-group">
											<label class="form-control-label" for="input-city">City</label>
											<input type="text" th:id="town"
												class="form-control form-control-alternative" th:name="town"
												placeholder="City"
												th:attr="value=${user_details.getTown()}">
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="form-control-label" for="input-country">Country</label>
											<input type="text" th:id="country"
												class="form-control form-control-alternative" th:name="country"
												placeholder="Country"
												th:attr="value=${user_details.getCountry()}">
												<!-- th:value="${user_details.getCountry()}" -->
										</div>
									</div>
									<div class="col-lg-4">
										<div class="form-group">
											<label class="form-control-label" for="input-password">Your
												Password (or change it)</label> <input th:name="password" required  type="password"
												onkeyup="CheckPasswordStrength(this.value)"
												id="password-field"
												class="form-control form-control-alternative"
												placeholder="New password"> <span
												style="float: right; margin-right: 4px; margin-top: -30px; position: relative; z-index: 2;"
												toggle="#password-field"
												class="fa fa-fw fa-eye field-icon toggle-password"></span> <span
												id='strength'
												style="font-size: 13px; float: right; margin-top: 3px;"></span>
												<input type="hidden"
												onkeyup="CheckPasswordStrength(this.value)"
												id="passwordHidden"
												class="form-control form-control-alternative"
												placeholder="New password" th:attr="value=${user_details.getPassword()}" >
										</div>
									</div>
								</div>
							</div>
							<!-- Description -->
						</div>
						<div class="col-lg-12">
							<div class="form-group">
								<button class="btn btn-info"
									style="float: right; margin-bottom: 20px;" type="submit">
									<i class="ni ni-check-bold"></i> Save Profile
								</button>
							</div>
						</div>
						</form>
					</div>
				</div>
			</div>
			<footer class="footer">
				<div class="row align-items-center justify-content-xl-between">
					<div class="col-xl-6">
						<div class="copyright text-center text-xl-left text-muted">
							&copy; 2019 <a href="" class="font-weight-bold ml-1"
								target="_blank">KAIZEN PLATFORM <span
								style="color: #8898aa">V 1.0</span></a>
						</div>
					</div>
				</div>
			</footer>

		</div>
	</div>
	<!-- Scripts -->
	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/assets/JqueryValidation/validation.js"></script>
	<script src="/assets/vendor/jquery/dist/jquery.min.js"></script>
	<script src="/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.22/js/uikit.min.js"></script>
	<script
		src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.0-rc.22/js/uikit-icons.min.js"></script>
	<script src="/assets/js/argon.js?v=1.0.0"></script>
	<script type="text/javascript">
		$('#show_data')
				.on(
						'show.bs.modal',
						function(event) {
							console.log('Modal Opened');
							var d = new Date();
							var year = d.getFullYear();
							var button = $(event.relatedTarget)
							var release_date = button.data('release_date')
							var receipent = button.data('receipent')
							var facilitator = button.data('facilitator')
							var problem = button.data('problem')
							var proposed = button.data('proposed_solution')
							var domaine = button.data('domaine')
							var id_sugg = button.data('id')
							var id_user = button.data('user_id')
							var adopted_solution = button
									.data('adopted_solution')
							var retained_sugg = button.data('retained_sugg')
							var sender = button.data('sender')
							var justification = button.data('justification')
							var file = button.data('file')
							var modal = $(this)
							modal.find('.modal-body #release_date').val(
									release_date);
							modal.find('.modal-body #receipent').val(receipent);
							modal.find('.modal-body #facilitator').val(
									facilitator);
							modal.find('.modal-body #prob_amelioration').val(
									problem);
							modal.find('.modal-body #proposed_solution').val(
									proposed);
							modal.find('.modal-body #suggestion_domaine').val(
									domaine);
							modal.find('.modal-header h3').text(
									'Submission Date : ' + release_date);
							modal.find('.modal-header #reference').text(
									'Ref : ' + id_sugg + '/' + year);
							modal.find('.modal-body #adopted_solution').val(
									adopted_solution);
							modal.find('.modal-body #justification').val(
									justification);
							modal.find('.modal-body #id_sugg').val(id_sugg);
							modal.find('.modal-body #id_user').val(id_user);
							modal.find('.modal-body #sender').val(sender);
							if (file == "") {
								modal.find('.modal-body #attached_file').text(
										"no attached file");
								modal.find('.modal-body #attached_file')
										.removeAttr("download");
								modal.find('.modal-body #attached_file')
										.removeAttr("href");
								modal.find('.modal-body #attached_file').css(
										"text-decoration", "none");
								modal.find('.modal-body #attached_file').css(
										"color", "gray");
							} else {
								modal
										.find('.modal-body #attached_file')
										.attr("href",
												"/uploads/attachements/" + file);
								modal.find('.modal-body #attached_file').text(
										file);
								modal.find('.modal-body #attached_file').attr(
										"download", file);
								modal.find('.modal-body #attached_file').css(
										"text-decoration", "none");
								modal.find('.modal-body #attached_file').css(
										"color", "#6a6be4");
							}
							if (retained_sugg == 2) {
								modal.find('.modal-body #retained_sugg').val(
										"Refused");
							} else if (retained_sugg == 1) {
								modal.find('.modal-body #retained_sugg').val(
										"Approved");
							} else {
								modal.find('.modal-body #retained_sugg').val(
										"Pending");
							}
						});
	</script>
	<script type="text/javascript">
		$(document)
				.ready(
						function() {
							$("#search")
									.on(
											"keyup",
											function() {
												var value = $(this).val()
														.toLowerCase();
												$(".searchable tr")
														.filter(
																function() {
																	$(this)
																			.toggle(
																					$(
																							this)
																							.text()
																							.toLowerCase()
																							.indexOf(
																									value) > -1)
																});
											});
						});
	</script>
	<script type="text/javascript">
		$(function() {
			$("input:file").change(function() {
				var fileName = $(this).val();
				if (fileName != "") {
					$(".filename").html("File uploaded");
					$(".filename").css("color", "green");
				} else {
					$(".filename").html("No file chosen");
					$(".filename").css("color", "red");
				}

			});
		});
	</script>

	<script type="text/javascript">
		$.ajaxSetup({
			headers : {
				'X-CSRF-TOKEN' : $('meta[name="csrf-token"]').attr('content')
			}
		});
		$('#supervisor').keyup(function() {
			var query = $(this).val();
			if (query != '') {
				var _token = $('input[name="_token"]').val();
				$.ajax({
					url : "{{ route('autocomplet_profile') }}",
					method : "GET",
					data : {
						query : query,
						_token : _token
					},
					success : function(data) {
						$('#supervisorlist').fadeIn();
						$('#supervisorlist').html(data);
					}
				})
			} else {
				$('#supervisorlist').fadeOut();
			}
		})
		function getValue(a) {
			var receipent = document.getElementById("supervisor");
			receipent.value = a.innerHTML;
			//console.log(a.innerHTML);
			$('#supervisorlist').fadeOut();
		}
	</script>
	<script type="text/javascript">
		$(".toggle-password").click(function() {

			$(this).toggleClass("fa-eye fa-eye-slash");
			var input = $($(this).attr("toggle"));
			if (input.attr("type") == "password") {
				input.attr("type", "text");
			} else {
				input.attr("type", "password");
			}
		});
	</script>
	<script type="text/javascript">
		$(".alert").fadeTo(2000, 500).slideUp(500, function() {
			$(".alert").slideUp(500);
		});
	</script>
</body>
</html>
